/**
 * HexStrike PDF 报告专用样式
 * 使用 WeasyPrint 将 HTML 转换为 PDF
 * 参考 SysReptor 的 PDF 生成方案
 */

/* 全局设置 */
@page {
    size: A4 portrait;
    margin: 20mm 20mm 20mm 20mm;

    /* 页眉 */
    @top-left {
        content: "HexStrike 安全评估报告";
        font-size: 9pt;
        color: #667eea;
        font-weight: bold;
        padding-bottom: 5mm;
        border-bottom: 1px solid #e0e0e0;
    }

    @top-right {
        content: "Page " counter(page) " / " counter(pages);
        font-size: 9pt;
        color: #999;
        text-align: right;
        padding-bottom: 5mm;
        border-bottom: 1px solid #e0e0e0;
    }

    /* 页脚 */
    @bottom-left {
        content: "Generated by HexStrike AI";
        font-size: 8pt;
        color: #ccc;
    }

    @bottom-right {
        content: counter(page);
        font-size: 8pt;
        color: #ccc;
    }
}

/* 封面页 */
@page cover {
    margin: 0;

    @top-left { content: none; }
    @top-right { content: none; }
    @bottom-left { content: none; }
    @bottom-right { content: none; }
}

.cover-page {
    page: cover;
    page-break-after: always;
}

/* 基础样式重置 */
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: 'Noto Sans SC', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', sans-serif;
    font-size: 11pt;
    line-height: 1.6;
    color: #333;
    background: white;
}

/* 容器 */
.container {
    max-width: 100%;
    margin: 0;
    padding: 0;
}

/* 封面样式 */
.cover-page .cover-content {
    width: 100%;
    height: 260mm;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    color: white;
    text-align: center;
}

.cover-page h1 {
    font-size: 48pt;
    margin-bottom: 20px;
}

.cover-page .subtitle {
    font-size: 18pt;
    margin-bottom: 40px;
    opacity: 0.9;
}

.cover-page .meta {
    font-size: 12pt;
    opacity: 0.85;
    margin-top: 20px;
}

/* 报告头部 */
.header {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 30px;
    border-radius: 8px;
    margin-bottom: 25px;
    page-break-inside: avoid;
}

.header h1 {
    font-size: 28pt;
    margin-bottom: 10px;
}

.header .subtitle {
    font-size: 14pt;
    opacity: 0.9;
}

.header .meta {
    margin-top: 15px;
    font-size: 11pt;
    opacity: 0.85;
}

/* 统计摘要卡片 */
.summary {
    display: flex;
    flex-wrap: wrap;
    gap: 15px;
    margin-bottom: 25px;
    page-break-inside: avoid;
}

.summary-card {
    flex: 1;
    min-width: 100px;
    background: white;
    padding: 20px;
    border-radius: 8px;
    text-align: center;
    border: 1px solid #e0e0e0;
}

.summary-card .number {
    font-size: 32pt;
    font-weight: bold;
    margin-bottom: 5px;
}

.summary-card .label {
    color: #666;
    font-size: 10pt;
}

.summary-card.risk-critical .number { color: #f56c6c; }
.summary-card.risk-high .number { color: #e6a23c; }
.summary-card.risk-medium .number { color: #409eff; }
.summary-card.risk-low .number { color: #67c23a; }
.summary-card.risk-info .number { color: #909399; }

/* 章节样式 */
.section {
    background: white;
    padding: 25px;
    border-radius: 8px;
    margin-bottom: 20px;
    border: 1px solid #e0e0e0;
    page-break-inside: avoid;
}

.section-title {
    font-size: 18pt;
    margin-bottom: 15px;
    padding-bottom: 10px;
    border-bottom: 3px solid #667eea;
    color: #667eea;
}

.section h3 {
    font-size: 14pt;
    margin-top: 20px;
    margin-bottom: 12px;
    color: #333;
}

/* 漏洞列表 */
.vulnerability-list {
    list-style: none;
}

.vulnerability-item {
    padding: 12px;
    margin-bottom: 10px;
    border-left: 4px solid #ddd;
    background: #f9f9f9;
    border-radius: 4px;
    page-break-inside: avoid;
}

.vulnerability-item.critical { border-left-color: #f56c6c; }
.vulnerability-item.high { border-left-color: #e6a23c; }
.vulnerability-item.medium { border-left-color: #409eff; }
.vulnerability-item.low { border-left-color: #67c23a; }
.vulnerability-item.info { border-left-color: #909399; }

.vulnerability-item .title {
    font-weight: bold;
    margin-bottom: 5px;
    font-size: 12pt;
}

.vulnerability-item .severity {
    display: inline-block;
    padding: 2px 8px;
    border-radius: 3px;
    font-size: 9pt;
    font-weight: bold;
    margin-right: 8px;
}

.severity-critical { background: #f56c6c; color: white; }
.severity-high { background: #e6a23c; color: white; }
.severity-medium { background: #409eff; color: white; }
.severity-low { background: #67c23a; color: white; }
.severity-info { background: #909399; color: white; }

.tag {
    display: inline-block;
    padding: 2px 6px;
    background: #ecf5ff;
    color: #409eff;
    border-radius: 3px;
    font-size: 9pt;
    margin: 2px;
}

/* 端口列表 */
.port-list {
    display: flex;
    flex-wrap: wrap;
    gap: 15px;
}

.port-item {
    flex: 1;
    min-width: 200px;
    padding: 12px;
    background: #f9f9f9;
    border-radius: 5px;
    border-left: 4px solid #67c23a;
    page-break-inside: avoid;
}

.port-item .port-number {
    font-size: 14pt;
    font-weight: bold;
    margin-bottom: 5px;
}

.port-item .service {
    color: #666;
    font-size: 10pt;
}

.risk-badge {
    display: inline-block;
    padding: 3px 10px;
    border-radius: 10px;
    font-size: 9pt;
    font-weight: bold;
    margin-left: 8px;
}

.risk-critical { background: #fee; color: #f56c6c; }
.risk-high { background: #fef0e0; color: #e6a23c; }
.risk-medium { background: #ecf5ff; color: #409eff; }
.risk-low { background: #f0f9ff; color: #67c23a; }

/* 建议区域 */
.recommendations {
    background: #f0f9ff;
    border-left: 4px solid #409eff;
    padding: 15px;
    border-radius: 4px;
    margin-bottom: 15px;
    page-break-inside: avoid;
}

.recommendations h3 {
    margin-bottom: 10px;
    margin-top: 0;
}

.recommendations ul {
    margin-left: 20px;
    margin-top: 10px;
}

.recommendations li {
    margin-bottom: 6px;
}

/* 页脚 */
.footer {
    text-align: center;
    padding: 15px;
    color: #999;
    font-size: 10pt;
    margin-top: 30px;
    border-top: 1px solid #e0e0e0;
}

/* 分页控制 */
.page-break {
    page-break-after: always;
}

.no-break {
    page-break-inside: avoid;
}

/* 表格样式 */
table {
    width: 100%;
    border-collapse: collapse;
    margin: 15px 0;
    page-break-inside: avoid;
}

table th,
table td {
    padding: 10px;
    text-align: left;
    border-bottom: 1px solid #e0e0e0;
}

table th {
    background: #f5f7fa;
    font-weight: bold;
    color: #333;
}

table tr:hover {
    background: #f9f9f9;
}

/* 链接样式 */
a {
    color: #667eea;
    text-decoration: none;
}

a[href^="http"] {
    color: #667eea;
}

/* 打印优化 */
@media print {
    body {
        background: white;
    }

    .container {
        max-width: 100%;
    }

    .section {
        page-break-inside: avoid;
    }

    .header {
        -webkit-print-color-adjust: exact;
        print-color-adjust: exact;
    }

    .summary-card {
        page-break-inside: avoid;
    }

    .vulnerability-item {
        page-break-inside: avoid;
    }

    .port-item {
        page-break-inside: avoid;
    }
}

/* 无障碍支持（PDF/UA-1）*/
.pdf-ua-1 {
    /* WeasyPrint 会自动添加无障碍标签 */
    structure-type: "Document";
    lang: "zh-CN";
}

/* 字体回退 */
@font-face {
    font-family: 'Noto Sans SC';
    src: local('Noto Sans SC'),
         local('PingFang SC'),
         local('Hiragino Sans GB'),
         local('Microsoft YaHei');
}